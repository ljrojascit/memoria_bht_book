<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Memoria de Cálculo MBHT - 5&nbsp; Dimensión Accesibilidad</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./consolidacion.html" rel="next">
<link href="./seguridad.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./accesibilidad.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Dimensión Accesibilidad</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Memoria de Cálculo MBHT</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefacio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./socioeconomico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Dimensión Socioeconómica</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ambiental.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Dimensión Ambiental</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./seguridad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Dimensión Seguridad</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accesibilidad.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Dimensión Accesibilidad</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./consolidacion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Consolidación de Dimensiones</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#resumen" id="toc-resumen" class="nav-link active" data-scroll-target="#resumen"><span class="header-section-number">5.1</span> Resumen</a></li>
  <li><a href="#insumos" id="toc-insumos" class="nav-link" data-scroll-target="#insumos"><span class="header-section-number">5.2</span> Insumos</a>
  <ul class="collapse">
  <li><a href="#red-de-calles" id="toc-red-de-calles" class="nav-link" data-scroll-target="#red-de-calles"><span class="header-section-number">5.2.1</span> Red de Calles</a></li>
  <li><a href="#manzanas-poblacionales" id="toc-manzanas-poblacionales" class="nav-link" data-scroll-target="#manzanas-poblacionales"><span class="header-section-number">5.2.2</span> Manzanas Poblacionales</a></li>
  <li><a href="#equipamientos" id="toc-equipamientos" class="nav-link" data-scroll-target="#equipamientos"><span class="header-section-number">5.2.3</span> Equipamientos</a></li>
  <li><a href="#información-encuesta-origen-y-destino" id="toc-información-encuesta-origen-y-destino" class="nav-link" data-scroll-target="#información-encuesta-origen-y-destino"><span class="header-section-number">5.2.4</span> Información Encuesta Origen y Destino</a></li>
  </ul></li>
  <li><a href="#proceso" id="toc-proceso" class="nav-link" data-scroll-target="#proceso"><span class="header-section-number">5.3</span> Proceso</a></li>
  <li><a href="#aplicación" id="toc-aplicación" class="nav-link" data-scroll-target="#aplicación"><span class="header-section-number">5.4</span> Aplicación</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Dimensión Accesibilidad</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><img src="img/01_accesibilidad.png" class="img-fluid"></p>
<section id="resumen" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="resumen"><span class="header-section-number">5.1</span> Resumen</h2>
<p>Este indicador busca medir el grado de acceso de la población a las oportunidades presentes en el territorio, con sus diferentes equipamientos y servicios. La dimensión se compone por seis indicadores: accesibilidad a equipamientos culturales, equipamientos deportivos, equipamientos de salud y de áreas verdes, y a servicios públicos y de educación.</p>
<p>Existe numerosa literatura sobre el acceso a oportunidades en el territorio y las distintas métricas que es posible construir. Destaca si el trabajo de <span class="citation" data-cites="geurs2004accessibility">(<a href="references.html#ref-geurs2004accessibility" role="doc-biblioref">Geurs and Van Wee 2004</a>)</span> que clasifica las métricas de acuerdo al tratmiento de cuatro componentes clave: la ubicación de las oportunidades y la población, las restricciones individuales, el sistema de transporte, y las restricciones temporales.</p>
<p>En este sentido el indicador calculado cae bajo la categoría de indicadores basados en locación, y respeta la ubicación de personas y oportunidades, incorpora las restricciones individuales mediante un parámetro de sensibilidad al costo de desplazarse que se deriva de la Encuesta de Origen y Destino, además de incorporar modos de transporte a pie y en vehículo mediante las calles de la ciudad. Esto se puede apreciar en la siguiente expresión:</p>
<p><span class="math display">\[
A_i = \sum_{j=1}^m D_j e^{-\beta c_{ij}}
\]</span></p>
<p>Donde <span class="math inline">\(A_i\)</span> es el indicador de accesibilidad, <span class="math inline">\(D_j\)</span> indica las oportunidades en el territorio y <span class="math inline">\(c_{ij}\)</span> el costo de desplazamiento.</p>
<p>El listado de indicadores de accesibilidad de la dimensión es el siguiente:</p>
<ul>
<li><p>IAV: Accesibilidad a Áreas Verdes.</p></li>
<li><p>ICUL: Accesibilidad a Cultura.</p></li>
<li><p>ISER: Accesibilidad a Servicios Públicos.</p></li>
<li><p>ISE: Accesibilidad a Educación.</p></li>
<li><p>IDEP: Accesibilidad a Áreas Deportivas.</p></li>
<li><p>ISAL: Accesibilidad a Equipamientos de Salud.</p></li>
</ul>
<p>En particular los indicadores de accesibilidad a equipamientos (ICUL, IDEP, ISAL e IAV), representan en m2 /habitante, la relación de capacidad de cada equipamiento (superficie o matrículas escolares, por ejemplo), y la población que puede acceder a los mismos; en relación a la distancia y a la propensión de desplazamiento.</p>
<p>Indicadores basados en locación</p>
<p>Donde <span class="math inline">\(A_i\)</span> indica el indicador de accesibilidad en la locación <span class="math inline">\(i\)</span> (manzanas con población), siendo <span class="math inline">\(D_j\)</span> la oportunidad presente en el equipamiento <span class="math inline">\(j\)</span>, además <span class="math inline">\(c_{ij}\)</span> indica el costo de desplazamiento entre la locación <span class="math inline">\(i\)</span> y <span class="math inline">\(j\)</span>, esta última ponderada exponencialmente por un parámetro <span class="math inline">\(\beta\)</span> que indica la dispocición de viaje o descuento por costo de desplazamiento en tiempo o distancia. La expresión muestra como el indicador de accesibilidad es la suma de oportunidades ponderadas por el costo de desplazamiento a estas.</p>
</section>
<section id="insumos" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="insumos"><span class="header-section-number">5.2</span> Insumos</h2>
<p>A continuación detallamos los insumos incluidos en el cálculo de estos indicadores. Estos comprenden:</p>
<ul>
<li><p>Red de Calles.</p></li>
<li><p>Manzanas Poblacionales.</p></li>
<li><p>Equipamientos.</p></li>
<li><p>Información de Encuesta de Origen y Destino.</p></li>
</ul>
<section id="red-de-calles" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="red-de-calles"><span class="header-section-number">5.2.1</span> Red de Calles</h3>
<p>La red de calles es un insumo que se expresa en formato geográfico como lineas conectadas. Estas requieren de procesos de limpieza que implican que en cada intersección exista un punto, y estos puntos estén correctamente conectados. Adicionalmente, en cada tramo debe existir información sobre el largo de este y además el tiempo de desplazamiento en este caminando, respetando la elevación que existe en cada tramo.</p>
<p>A modo de ilustración se muestra la red de calles regional de la Región de Tarapacá. Se destaca la ubicación de la ciudad de Iquique dentro de la región.</p>
<p><img src="img/red-01.png" class="img-fluid"></p>
<p>El proceso que se aplica a esta red de calles implica transformarla al tipo de dato grafo conectado, el cual permite la apliación de algoritmos de ruta que buscan optimizar los desplazamientos para encontrar las rutas más cortas. Un ejemplo de esta optimización se presenta en la siguiente imagen. Son estas rutas más cortas las que representarán los costos de desplazamiento entre la población y las oportunidades del territorio.</p>
<p><img src="img/ej-ruta-iqq.jpeg" class="img-fluid"></p>
</section>
<section id="manzanas-poblacionales" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="manzanas-poblacionales"><span class="header-section-number">5.2.2</span> Manzanas Poblacionales</h3>
<p>Las manzanas poblacionales son los ya conocidos polígonos que cuentan con datos de habitantes, y habitantes por grupos de interés. Por ejemplo, el número de personas en edad de estudiar. Esto es importante para luego vincular estos grupos poblacionales con las oportunidades específicas que necesitan, como son matrículas en establecimientos educacionales.</p>
</section>
<section id="equipamientos" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="equipamientos"><span class="header-section-number">5.2.3</span> Equipamientos</h3>
<p>Los equipamientos presentan las oportunidades en el territorio. Estos pueden expresar superficie, nivel de atención, matrículas, etc. Además, existen dos tipos de equipamientos: locales y metropolitanos. Los equipamientos locales son aquellos que sirven a la población en un tiempo más acotado; pudiendo llegar a estos caminando, y mantienen una importancia local en el territorio; y los de carácter metropolitano, aquellos que tienen una gran importancia para el territorio, por lo que, la población en su totalidad podría asistir.</p>
<p>La imagen a continuación indica los equipamientos de Cultura en la ciudad de Iquique, y el tamaño del punto indica el nivel de oportunidades que representan.</p>
<p><img src="images/ind_cul_l.png" class="img-fluid"></p>
</section>
<section id="información-encuesta-origen-y-destino" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="información-encuesta-origen-y-destino"><span class="header-section-number">5.2.4</span> Información Encuesta Origen y Destino</h3>
<p>Finalmente, usando los datos de la Encuesta de Origen y Destino (EOD) se calcula el parámetro de sensibilidad al costo de desplazamiento <span class="math inline">\(\beta\)</span>, este indica el nivel de decaimiento exponencial en la probabilidad de hacer un viaje a medida que aumenta el costo de desplazamiento la probabilidad de realizar el viaje disminuye. La imagen a continuación indica como se comporta este parámetro, siendo el eje y el que indica la probabilidad de realizar el viaje (entre 0 y 1) y el eje x indicando el costo en tiempo. Se aprecia que existe un tramo de costo donde el viaje se realizar con probabilidad 1, en este caso en viajes de menos de 5 minutos. Luego, la probabilidad decae exponencialmente siguiendo el parámetro <span class="math inline">\(\beta\)</span>. Esta curva es una aproximación empírica de la consolidación de viajes registrados en la EOD, en modo caminata para un propósito libre.</p>
<p><img src="img/imp_caminata.png" class="img-fluid"></p>
</section>
</section>
<section id="proceso" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="proceso"><span class="header-section-number">5.3</span> Proceso</h2>
<p>El objetivo es calcular el indicador de oportunidades per cápita de la población, lo que puede expresarse siguiendo las siguientes fórmulas:</p>
<p><span class="math display">\[ C_j = \sum_{i=1}^n P_i e^{-\beta c_{ij}} \]</span></p>
<p><span class="math display">\[ A_i = \sum_{j=1}^m (D_j/C_j) e^{-\beta c_{ij}} \]</span></p>
<p>Estas ilustran el proceso de cálculo, indicando que primero se calcula la población que realiza el viaje desde su residencia <span class="math inline">\(P_i\)</span> a la ubicación de las oportunidades, siendo sumadas en el destino <span class="math inline">\(C_j\)</span>. Este valor luego divide las oportunidades en el destino, para expresarlas en términos percápita <span class="math inline">\((D_j/C_j)\)</span> siendo este el valor repartido a los puntos de origen y expresado en <span class="math inline">\(A_i\)</span>.</p>
<p>Para esto el proceso considera los distintos insumos de entrada para procesarlos con el objetivo de calcular el elemento <span class="math inline">\(e^{\beta c_{ij}}\)</span> que se representa como una matriz de probabilidad de viajes. Esta última es el insumo clave que pondera la población para calcular las cargas y luego las oportunidades per-cápita para calcular el indicador.</p>
<p><img src="images/diagrama-accesibilidad.PNG" class="img-fluid"></p>
</section>
<section id="aplicación" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="aplicación"><span class="header-section-number">5.4</span> Aplicación</h2>
<p>Demostramos el flujo de trabajo mediante el uso de una librería interna que empaqueta el proceso de cálculo, llamada `Accesibilidad`. Comenzamos por configurar el entorno de trabajo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># configura entorno de trabajo</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Accesibilidad)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A partir de esto podemos cargar la información de entrada: manzanas poblacionales, equipamientos y red de calles:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># manzanas</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mz <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/mz_iqq.shp"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># equipamientos</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>equip <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/av_iqq.shp"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)<span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># red </span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>red <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/red.shp"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La información de la EOD ya se encuentra preprocesada y los parámetros <span class="math inline">\(\beta\)</span> ya se encuentran precalculados, por lo que cargamos esta información adicional:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># beta</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>impedancias <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(<span class="st">'data/impedancias.txt'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">separate</span>(tipo, <span class="fu">c</span>(<span class="st">"modo"</span>,<span class="st">"proposito"</span>), <span class="st">"_"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># clasifica indicador</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>iterador <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"data/indice_accesibilidad.csv"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(itera_accesibilidad <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Con esto podemos calcular el indicador mediante la función empaquetada que toma los insumos que hemos cargado. Esta se preocupa de limpiar la red de calles, construir el grafo, asociar los puntos de origen y destino a nodos en el grafo y construir la matriz de costos de desplazamiento óptimo, a partir de lo cual calcula los indicadores de accesibilidad:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>conf_indicador <span class="ot">&lt;-</span> <span class="st">"IAV"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ret <span class="ot">&lt;-</span> Accesibilidad<span class="sc">::</span><span class="fu">accesibilidad</span>(impedancias, iterador, conf_indicador, mz, equip, red)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cleaning graph...
Initial node ordering...
Contracting nodes...
Cleaning graph...
Initial node ordering...
Contracting nodes...

-----------LOCAL-----------
Calculando matrices de tiempo
Consolidando matrices distancia origen destino
Aplica funcion sensibilidad de costo (impedancia)
Calculando demanda potencial (cargas)
Calculo indicador

-----------METRO-----------
Calculando matrices de distancia y tiempo
Consolidando matrices distancia origen destino
Aplica funcion sensibilidad de costo (impedancia)
Calculando demanda potencial (cargas)
Calculo indicador
[1] "Los Resultados de Indicador SI Coinciden con lo Repartido"
[1] "Check Pass-- Indicador: IAV"
[1] "Las Manzanas con poblacion relevante cero no tienen indicador"
[1] "Check Pass -- Indicador: IAV"
[1] "Se agrego la accesibilidad de IAV"</code></pre>
</div>
</div>
<p>El resultado se expresa sobre las manzanas de entrada, añadiendo una nueva columna con el valor del indicador:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 17 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 379960.4 ymin: 7764928 xmax: 381960.7 ymax: 7765428
Projected CRS: WGS 84 / UTM zone 19S
        ID_MANZ MANZ_EN COD_REG COD_PROV COD_COM       ZONA       AREA
1 1101021005003  URBANO       1       11    1101 1101021005 513023.198
2 1101021005021  URBANO       1       11    1101 1101021005  36705.997
3 1101021005016  URBANO       1       11    1101 1101021005   6125.433
4 1101021005013  URBANO       1       11    1101 1101021005   8032.154
5 1101021005015  URBANO       1       11    1101 1101021005   6420.489
6 1101021005022  URBANO       1       11    1101 1101021005   4649.203
             NOM_REG NOM_PROV NOM_COM       ID_MANZCIT TOTAL_V HOG_N PERSONAS
1 REGIÓN DE TARAPACÁ  IQUIQUE IQUIQUE 1101021005003001       4     5       10
2 REGIÓN DE TARAPACÁ  IQUIQUE IQUIQUE 1101021005021001     277   266      915
3 REGIÓN DE TARAPACÁ  IQUIQUE IQUIQUE 1101021005016001       6     7       23
4 REGIÓN DE TARAPACÁ  IQUIQUE IQUIQUE 1101021005013001      12    13       49
5 REGIÓN DE TARAPACÁ  IQUIQUE IQUIQUE 1101021005015001      17    17       53
6 REGIÓN DE TARAPACÁ  IQUIQUE IQUIQUE 1101021005022001      54    49      175
  E4A18 E15A24       IAV                       geometry
1     1      0 0.5088645 POLYGON ((381959.8 7765083,...
2   280    105 0.8241874 POLYGON ((380236.6 7765250,...
3     2      6 0.8147927 POLYGON ((380332.4 7765174,...
4    23      7 0.8299646 POLYGON ((380492.1 7765127,...
5     8     12 0.8416961 POLYGON ((380332.9 7765046,...
6    58     21 0.8261619 POLYGON ((379984.1 7765040,...</code></pre>
</div>
</div>
<p>Podemos revisar el resultado en el territorio:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(ret) <span class="sc">+</span> <span class="fu">tm_fill</span>(<span class="st">"IAV"</span>, <span class="at">style=</span><span class="st">"jenks"</span>, <span class="at">palette=</span><span class="st">"RdYlGn"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="accesibilidad_files/figure-html/acc-viz-1.png" class="img-fluid" width="672"></p>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-geurs2004accessibility" class="csl-entry" role="listitem">
Geurs, Karst T, and Bert Van Wee. 2004. <span>“Accessibility Evaluation of Land-Use and Transport Strategies: Review and Research Directions.”</span> <em>Journal of Transport Geography</em> 12 (2): 127–40.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./seguridad.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Dimensión Seguridad</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./consolidacion.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Consolidación de Dimensiones</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>